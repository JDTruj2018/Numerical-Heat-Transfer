% Author: Jered Dominguez-Trujillo

\documentclass[10pt, letter, showtrims]{extarticle}

% Packages
% Packages
\usepackage[paperwidth=20cm, paperheight=26cm, margin=1in]{geometry}
\usepackage[letter, frame, center, noinfo]{crop}
\usepackage{graphicx}
% \usepackage{showframe}
\usepackage{fancyhdr}
\usepackage{float}
\usepackage{caption}
\usepackage{color, colortbl}
\usepackage[labelfont=bf]{caption}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}
\usepackage{esdiff}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{color}
\usepackage{placeins}
\usepackage{adjustbox}
\usepackage{empheq}
\usepackage{xcolor}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
	language=Matlab,
	aboveskip=3mm,
	belowskip=3mm,
	showstringspaces=false,
	columns=flexible,
	basicstyle={\footnotesize\ttfamily},
	numbers=none,
	numberstyle=\tiny\color{gray},
	keywordstyle=\color{blue},
	commentstyle=\color{dkgreen},
	stringstyle=\color{mauve},
	breaklines=true,
	breakatwhitespace=true,
	tabsize=3
}

\usepackage{enumitem}
\setenumerate[1]{label=\Roman*.}
\setenumerate[2]{label=\Alph*.}
\setenumerate[3]{label=\roman*.}
\setenumerate[4]{label=\alph*.}

\newcommand{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommand{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
\newcommand{\info}[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
\newcommand{\improvement}[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}
\newcommand{\thiswillnotshow}[2][1=]{\todo[disable,#1]{#2}}

\newcommand{\boxedeq}[2]{\begin{empheq}[box={\fboxsep=6pt\fbox}]{align}\label{#1}#2\end{empheq}}
\newcommand{\coloredeq}[2]{\begin{empheq}[box=\colorbox{gray}]{align}\label{#1}#2\end{empheq}}

\newcommand{\specialcell}[2][c]{%
	\begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}

\definecolor{Gray}{gray}{0.9}

%Commands
\renewcommand{\headrulewidth}{2pt}
\renewcommand{\footrulewidth}{1pt}

\newcommand{\University}{Massachusetts Institute of Technology}
\newcommand{\ClassCode}{18.0851}
\newcommand{\ClassTitle}{Computational Science and Engineering I}
\newcommand{\Title}{Project Report}
\newcommand{\FirstName}{Jered}
\newcommand{\LastName}{Dominguez-Trujillo}
\newcommand{\ProfTitle}{Prof.}
\newcommand{\ProfFirst}{Matthew}
\newcommand{\ProfLast}{Durey}

% Page Style
\pagestyle{fancy}
\fancyhf{}
\rhead{\FirstName{} \LastName{}}
\lhead{\Title{}}
\rfoot{Page \thepage}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\newcommand*{\titleGP}{\begingroup % Create the command for including the title page in the document
\centering % Center all text
% \vspace*{\baselineskip} % White space at the top of the page

\textsc{\LARGE \University{}} \\[2\baselineskip] % Editor affiliation

\rule{\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt} % Thick horizontal line
\rule{\textwidth}{0.4pt}\\[\baselineskip] % Thin horizontal line

{\LARGE \Title{}}\\[0.2\baselineskip] % Title

\rule{\textwidth}{0.4pt}\vspace*{-\baselineskip}\vspace{3.2pt} % Thin horizontal line
\rule{\textwidth}{1.6pt}\\[\baselineskip] % Thick horizontal line

\scshape % Small caps
{\large \ClassCode{}} \\[0.5\baselineskip]
{\large \ClassTitle{}} \\[4\baselineskip]

% \vspace*{\baselineskip} % Whitespace between location/year and editors

Written by \\[0.5\baselineskip]
{\Large \FirstName{} \LastName{}}\\[2\baselineskip] % Editor list
% \vspace*{2\baselineskip}
Submitted to: \\[0.5\baselineskip]
{\Large \ProfTitle{} \ProfFirst{} \ProfLast{}\par} % Editor list
\vspace*{16\baselineskip}
{\large \today}\par 
\vfill % Whitespace between editor names and publisher logo

\endgroup}

\begin{document} 
	\begin{titlepage}
		\titleGP{}
	\end{titlepage}

	\section{Problem Description}

		\noindent
		\textbf{One-Dimensional Heat Equation}
		
		\begin{equation}
			\frac{\partial u}{\partial t} = K \frac{\partial^{2} u}{\partial x^{2}} + q(x, t)
		\end{equation}

		\noindent
		\textbf{Assumptions}
	
		\noindent
		1. Uniform Grid Spacing ($\Delta x$) \\
		2. Uniform Time Steps   ($\Delta t$) \\	

		\noindent
		\textbf{Variables}
		
		\noindent
		Length of Domain: $L = 2*\pi$	\\
		Left Boundary Condition: $C_{1} = 1$ \\
		Right Boundary Condition: $C_{2} = -0.2$ \\
		Thermal Diffusivity: $K = 0.1$ \\
		Time Ramp: $t_{ramp} = 1$ \\

		\noindent
		\textbf{Initial Conditions}
		
		\begin{equation}
			u(x, t = 0) = 0
		\end{equation}	
	
		\noindent
		\textbf{Boundary Conditions}

		\noindent
		Dirilecht Condition at the Left Boundary x = 0:
	
		\begin{equation}
			u(x=0, t) = \begin{cases} 
          					C_{1} * \frac{t}{t_{ramp}} & t\leq t_{ramp} \\
          					C_{1}                      & t > t_{ramp}
       					\end{cases}
    		\end{equation}
    
    		\noindent
    		Neumann Condition at the Right Boundary x = L:
    
    		\begin{equation}
			\frac{\partial u}{\partial x}(x=L, t) = C_{2}
    		\end{equation}		

		\noindent
		\textbf{Heating Source Function}
		
%		\begin{equation}
%			q(x, t) = 0
%		\end{equation}
		
		\begin{equation}
			q(x, t) = -sin(\omega t) * exp\left(\frac{-(x - \frac{L}{2})^{2}}{\sigma^{2}}\right)
		\end{equation}	
	
		\noindent
		\textbf{Second Order Finite Difference}
		
		\noindent
		At time t, where $u^{(n)} = \frac{\partial^{n} u}{\partial x^{n}}$  \\ \\
		Taylor Expansions:
		
		\begin{equation}
			u(x + \Delta x) = u(x) + \Delta x u^{(1)}(x) + \frac{1}{2} (\Delta x)^{2} u^{(2)}(x) + \frac{1}{6} (\Delta x)^{3} u^{(3)}(x) + O(h^{4})
		\end{equation}	
		
		\begin{equation}
			u(x - \Delta x) = u(x) - \Delta x u^{(1)}(x) + \frac{1}{2} (\Delta x)^{2} u^{(2)}(x) - \frac{1}{6} (\Delta x)^{3} u^{(3)}(x) + O(h^{4})
		\end{equation}
		
		\begin{equation}
			u(x + \Delta x) + u(x - \Delta x) = 2u(x) + (\Delta x)^{2} u^{(2)}(x) + O(h^{4})
		\end{equation}	
		
		\begin{equation}
			u^{(2)}(x) = \frac{u(x + \Delta x) - 2 u(x) + u(x - \Delta x)}{(\Delta x)^{2}} + O(h^{2})
		\end{equation}	
		
		\pagebreak
		
		\noindent
		\textbf{Explicit Euler}

		\noindent
		Let $n$ denote the time step, and $i$ denote the grid point
		
		\begin{equation}
			u_{n+1,i} - u_{n,\i} = \int_{t_{n}}^{t_{n+1}} f(t, u(t)) dt = \Delta t * f(t_{n}, u_{n}) = \Delta t \big[ K \frac{\partial^{2} u_{n}}{\partial x^{2}} + q_{n}(x) \big]_{i}
		\end{equation}	
		
		\begin{equation}
			u_{n+1,i} - u_{n,\i} = \Delta t \big[ K \big(\frac{u_{n}(x + \Delta x) - 2 u_{n}(x) + u_{n}(x - \Delta x)}{(\Delta x)^{2}}\big) + q_{n}(x) \big]_{i}
		\end{equation}
		
		\noindent
		Where
		
		\begin{equation}
			\begin{split}
				u_{n}(x + \Delta x) = u_{n,i+1} \\
				u_{n}(x)            = u_{n,i} \\
				u_{n}(x - \Delta x) = u_{n,i-1}
			\end{split}
		\end{equation}
		
		\begin{equation}
			u_{n+1,i} - u_{n,i} = \Delta t \big[ K \big(\frac{u_{n,i+1} - 2 u_{n,i} + u_{n,\i-1}}{(\Delta x)^{2}}\big) + q_{n,i}(x) \big]
		\end{equation}
		
		\begin{equation}
			u_{n+1,i} = u_{n,i} + \Delta t \big[ K \big(\frac{u_{n,i+1} - 2 u_{n,i} + u_{n,\i-1}}{(\Delta x)^{2}}\big) + q_{n,i}(x) \big]
		\end{equation}
		
		\noindent
		We define the CFL Number to be:
		
		\begin{equation}
			CFL = K \frac{\Delta t}{(\Delta x)^{2}}
		\end{equation}
	
		\boxedeq{}{u_{n+1,i} = CFL * u_{n,i+1} + (1 - 2 CFL) * u_{n,i} + CFL * u_{n,i-1} + q_{n,i} \Delta t}
		
		\pagebreak
		
		\noindent
		\textbf{Implicit Euler}
		
		\noindent
		Let n denote the time step, and i denote the grid point
		
		\begin{equation}
			u_{n+1,i} = u_{n,i} + \Delta t * f(t_{n+1}, u_{n+1}) = u_{n,i} + \Delta t \big[ K \frac{\partial^{2} u_{n+1}}{\partial x^{2}} + q_{n}(x)\big]_{i}
		\end{equation}
		
		\begin{equation}
			u_{n+1,i} = u_{n,i} + \Delta t \big[ K \big(\frac{u_{n+1}(x + \Delta x) - 2 u_{n+1} (x) + u_{n+1} (x - \Delta x)}{\Delta x^{2}} \big) + q_{n}(x)\big]_{i}
		\end{equation}
	
		\noindent
		Where
		
		\begin{equation}
			\begin{split}
				u_{n+1}(x + \Delta x) = u_{n+1,i+1} \\
				u_{n+1}(x)            = u_{n+1,i} \\
				u_{n+1}(x - \Delta x) = u_{n+1,i-1}
			\end{split}
		\end{equation}
		
		\begin{equation}
			u_{n+1,i} = u_{n,i} + \Delta t \big[ K \big(\frac{u_{n+1,i+1} - 2 u_{n+1,i} + u_{n+1,i-1}}{\Delta x^{2}} \big) + q_{n,i}(x)\big]
		\end{equation}
		
		\begin{equation}
			u_{n+1,i} - \Delta t \big[ K \big(\frac{u_{n+1,i+1} - 2 u_{n+1,i} + u_{n+1,i-1}}{\Delta x^{2}} \big)\big] =  u_{n,i} + q_{n,i}(x)
		\end{equation}
		
		\begin{equation}
			u_{n+1,i} - \frac{K \Delta t}{(\Delta x)^{2}} \big[ u_{n+1,i+1} - 2 u_{n+1,i} + u_{n+1,i-1} \big] =  u_{n,i} + q_{n,i}(x)
		\end{equation}
		
		\noindent
		We define the CFL Number to be:
		
		\begin{equation}
			CFL = K \frac{\Delta t}{(\Delta x)^{2}}
		\end{equation}
		
		\boxedeq{}{-CFL * u_{n+1,i+1} + (2 CFL + 1) * u_{n+1,i} - CFL * u_{n+1,i-1} = u_{n,i} + q_{n,i} \Delta t}
		
		\noindent
		\textbf{Boundary Conditions} \\
		
		\noindent
		1) Dirilecht Condition at the Left Boundary x = 0:	\\
		
		\begin{equation}
			u(x=0, t) = \begin{cases} 
          					C_{1} * \frac{t}{t_{ramp}} & t\leq t_{ramp} \\
          					C_{1}                      & t > t_{ramp}
       					\end{cases}
    		\end{equation}
    		
    		\begin{equation}
			-CFL * f_{BC1} + (2CFL + 1) * u_{n+1,2} - CFL * u_{n+1,3} = u_{n,2} + q_{n,2}\Delta t
		\end{equation} 
		
		\boxedeq{}{(2CFL + 1) * u_{n+1,2} - CFL * u_{n+1,3} = u_{n,2} + q_{n,2}\Delta t + CFL * f_{BC1}} 
		
		\pagebreak
		
		\noindent
		2) Neumann Condition at the Right Boundary x = L: \\
		
		\begin{equation}
			\frac{\partial u}{\partial x}(x=L, t) = C_{2}
    		\end{equation}
    		
    		\noindent
    		Forward Difference
    		
    		\begin{equation}
    			\frac{u_{n+1,i+1} - u_{n+1,i}}{\Delta x} = C_{2}
    		\end{equation}
    		
    		\begin{equation}
    			u_{n+1,i+1} = C_{2} \Delta x + u_{n+1,i}
    		\end{equation}
    		
    		\noindent
    		Where $i+1 = m$ and $m$ represents the last node (ghost node)
    		
    		\begin{equation}
    			u_{n+1,m} = C_{2} \Delta x + u_{n+1,m-1}
    		\end{equation}
    		
    		\noindent
    		Plugging in
    		
    		\begin{equation}
    			-CFL * u_{n+1,m-2} + (1 + 2CFL) * u_{n+1,m-1} - CFL * u_{n+1,m} = u_{n,m-1} + q_{n,m-1} \Delta t
    		\end{equation}
    		
    		\begin{equation}
    			-CFL * u_{n+1,m-2} + (1 + 2CFL) * u_{n+1,m-1} - CFL * \big(C_{2} \Delta x + u_{n+1,m-1} \big) = u_{n,m-1} + q_{n,m-1} \Delta t
    		\end{equation}
    		
    		\begin{equation}
    			-CFL * u_{n+1,m-2} + (1 + CFL) * u_{n+1,m-1} - CFL * C_{2} \Delta x  = u_{n,m-1} + q_{n,m-1} \Delta t
    		\end{equation}
    		
    		\boxedeq{}{-CFL * u_{n+1,m-2} + (1 + CFL) * u_{n+1,m-1} = u_{n,m-1} + q_{n,m-1} \Delta t + CFL * C_{2} \Delta x}
    		
    		\noindent
    		Central Difference
    		
    		\begin{equation}
    			\frac{u_{n+1,i+1} - u_{n+1,i-1}}{2 \Delta x} = C_{2}
    		\end{equation}
    		
    		\begin{equation}
    			u_{n+1,i+1} = 2 C_{2} \Delta x + u_{n+1,i-1}
    		\end{equation}
    		
    		\noindent
    		Where $i+1 = m$ and $m$ represents the last node (ghost node)
    		
    		\begin{equation}
    			u_{n+1,m} = 2 C_{2} \Delta x + u_{n+1,m-2}
    		\end{equation}
    		
    		\noindent
    		Plugging in

		\begin{equation}
			-CFL * u_{n+1,m-2} + (1 + 2 CFL) * u_{n+1,m-1} - CFL * (2 C_{2} \Delta x + u_{n+1,m-2}) = u_{n,m-1} + q_{n,m-1} \Delta t
		\end{equation}    		
    		
    		\boxedeq{}{-2CFL * u_{n+1,m-2} + (1 + 2 CFL) * u_{n+1,m-1} = u_{n,m-1} + q_{n,m-1} \Delta t + 2CFL * C_{2} \Delta x}
    		
		\pagebreak
		
		\noindent
		\textbf{Crank-Nicolson}
		
		\noindent
		Let n denote the time step, and i denote the grid point
		
		\begin{equation}
			u_{n+1,i} = u_{n,i} + \Delta t * \Big[ \frac{1}{2} f(t_{n}, u_{n}) + \frac{1}{2} f(t_{n+1}, u_{n+1}) + q_{n} \Big]_{i}
		\end{equation}
		
		\begin{equation}
			u_{n+1,i} = u_{n,i} + \Delta t * \Big[ \frac{1}{2} \big( K \frac{\partial^{2} u_{n}}{\partial x^{2}} \big) + \frac{1}{2} \big( K \frac{\partial^{2} u_{n+1}}{\partial x^{2}} \big) + q_{n} \Big]_{i}
		\end{equation}
		
		\begin{equation}
			\begin{split}
			u_{n+1,i} = u_{n,i} + \Delta t * \Big[ \frac{1}{2} \big( K \frac{u_{n}(x + \Delta x) - 2 u_{n}(x) + u_{n}(x - \Delta x)}{\Delta x^{2}} \big) \\
			 \frac{1}{2} \big( K \frac{u_{n+1}(x + \Delta x) - 2 u_{n+1}(x) + u_{n+1}(x - \Delta x)}{\Delta x^{2}} \big) + q_{n} \Big]_{i}
			\end{split}
		\end{equation}
		
		\noindent
		Where
		
		\begin{equation}
			\begin{split}
				u_{n}(x + \Delta x) = u_{n,i+1} \\
				u_{n}(x)            = u_{n,i} \\
				u_{n}(x - \Delta x) = u_{n,i-1}
			\end{split}
		\end{equation}
		
		\noindent
		And
		
		\begin{equation}
			\begin{split}
				u_{n+1}(x + \Delta x) = u_{n+1,i+1} \\
				u_{n+1}(x)            = u_{n+1,i} \\
				u_{n+1}(x - \Delta x) = u_{n+1,i-1}
			\end{split}
		\end{equation}
		
		\begin{equation}
			\begin{split}
			u_{n+1,i} = u_{n,i} + \Delta t * \Big[ \frac{1}{2} \big( K \frac{u_{n,i+1} - 2 u_{n,i} + u_{n,i-1}}{\Delta x^{2}} \big) \\
			 \frac{1}{2} \big( K \frac{u_{n+1,i+1} - 2 u_{n+1,i} + u_{n+1,i-1}}{\Delta x^{2}} \big) + q_{n,i} \Big]
			\end{split}
		\end{equation}
		
		\noindent
		We define the CFL Number to be:
		
		\begin{equation}
			CFL = K \frac{\Delta t}{(\Delta x)^{2}}
		\end{equation}
		
		\boxedeq{}{\frac{-CFL}{2} * u_{n+1,i-1} + (1 + CFL) * u_{n+1, i} - \frac{-CFL}{2} * u_{n+1,i+1} = \\ \frac{CFL}{2} * u_{n,i-1} + (1 - CFL) * u_{n,i} + \frac{CFL}{2} * u_{n,i+1} + q_{n,1} \Delta t}
		
		\pagebreak
		
		\noindent
		1) Dirilecht Condition at the Left Boundary x = 0:	\\
		
		\begin{equation}
			u(x=0, t) = u_{n+1, 1} = \begin{cases} 
          					C_{1} * \frac{t}{t_{ramp}} & t\leq t_{ramp} \\
          					C_{1}                      & t > t_{ramp}
       					\end{cases} = f_{BC1}
    		\end{equation}  		

		\begin{equation}
			\begin{split}
			\frac{-CFL}{2} * f_{BC1} + (1 + CFL) * u_{n+1, i} - \frac{-CFL}{2} * u_{n+1,i+1} = \\ 
			\frac{CFL}{2} * u_{n,i-1} + (1 - CFL) * u_{n,i} + \frac{CFL}{2} * u_{n,i+1} + q_{n,1} \Delta t
			\end{split}
		\end{equation}
		
		\boxedeq{}{(1 + CFL) * u_{n+1, i} - \frac{CFL}{2} * u_{n+1,i+1} = \\ \frac{CFL}{2} * u_{n,i-1} + (1 - CFL) * u_{n,i} + \frac{CFL}{2} * u_{n,i+1} + q_{n,1} \Delta t + \frac{CFL}{2} * f_{BC1}}    		
    		
		\noindent
		2) Neumann Condition at the Right Boundary x = L: \\
		
		\begin{equation}
			\frac{\partial u}{\partial x}(x=L, t) = C_{2}
    		\end{equation}
    		
    		\noindent
    		Forward Difference
    		
    		\begin{equation}
    			\frac{u_{n+1,i+1} - u_{n+1,i}}{\Delta x} = C_{2}
    		\end{equation}
    		
    		\begin{equation}
    			u_{n+1,i+1} = C_{2} \Delta x + u_{n+1,i}
    		\end{equation}
    		
    		\noindent
    		Where $i+1 = m$ and $m$ represents the last node (ghost node)
    		
    		\begin{equation}
    			u_{n+1,m} = C_{2} \Delta x + u_{n+1,m-1}
    		\end{equation}
    		
    		\noindent
    		Plugging in

		\begin{equation}
			\begin{split}
			\frac{-CFL}{2} * u_{n+1,i-1} + (1 + CFL) * u_{n+1, i} - \frac{CFL}{2} * \big ( C_{2} \Delta x + u_{n+1,i} \big) = \\
			 \frac{CFL}{2} * u_{n,i-1} + (1 - CFL) * u_{n,i} + \frac{CFL}{2} * u_{n,i+1} + q_{n,1} \Delta t
			 \end{split}
		\end{equation} 
		
		\boxedeq{}{\frac{-CFL}{2} * u_{n+1,i-1} + (1 + \frac{CFL}{2}) * u_{n+1, i} = \\
			 \frac{CFL}{2} * u_{n,i-1} + (1 - CFL) * u_{n,i} + \frac{CFL}{2} * u_{n,i+1} + q_{n,1} \Delta t + \frac{CFL}{2} * \big ( C_{2} \Delta x \big)}   		
    		
    		\pagebreak
    		
    		\noindent
    		Central Difference
    		
    		\begin{equation}
    			\frac{u_{n+1,i+1} - u_{n+1,i-1}}{2 \Delta x} = C_{2}
    		\end{equation}
    		
    		\begin{equation}
    			u_{n+1,i+1} = 2 C_{2} \Delta x + u_{n+1,i-1}
    		\end{equation}
    		
    		\noindent
    		Where $i+1 = m$ and $m$ represents the last node (ghost node)
    		
    		\begin{equation}
    			u_{n+1,m} = 2 C_{2} \Delta x + u_{n+1,m-2}
    		\end{equation}
    		
    		\noindent
    		Plugging in
    		
    		\begin{equation}
    			\begin{split}
    			\frac{-CFL}{2} * u_{n+1,i-1} + (1 + CFL) * u_{n+1, i} - \frac{CFL}{2} * \big( 2 C_{2} \Delta x + u_{n+1,i-1} \big) = \\ 
    			\frac{CFL}{2} * u_{n,i-1} + (1 - CFL) * u_{n,i} + \frac{CFL}{2} * u_{n,i+1} + q_{n,1} \Delta t
    			\end{split}
    		\end{equation}
    		
    		\boxedeq{}{-CFL * u_{n+1,i-1} + (1 + CFL) * u_{n+1, i} = \\ 
    			\frac{CFL}{2} * u_{n,i-1} + (1 - CFL) * u_{n,i} + \frac{CFL}{2} * u_{n,i+1} + q_{n,1} \Delta t + \frac{CFL}{2} * \big( 2 C_{2} \Delta x \big)}
    		
		\pagebreak
		
		\pagebreak	
	
	\section{Appendix}
	
	\centerline{\textit{MATLAB Code for Numerical Solution of Heat Equation}}
	\lstinputlisting[label=lst:p1, caption=Numerical Heat Equation, breaklines]{NumHT.m}
	
\end{document}